{"componentChunkName":"component---src-templates-blog-post-js","path":"/Next.js/next-redux-wrapper/","result":{"data":{"site":{"siteMetadata":{"title":"Hyem.log","author":"[hyem]","siteUrl":"https://hyemin-jang.github.io","comment":{"disqusShortName":"","utterances":"hyemin-jang/hyemin-jang.github.io"},"sponsor":{"buyMeACoffeeId":"jbee"}}},"markdownRemark":{"id":"58090e1c-d89f-56aa-93fb-4faef898a96d","excerpt":"Next.jsì˜ Pre-rendering Next.jsëŠ” Reactë¡œ SSR(Server Side Rendering)ì„ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” í”„ë ˆì„ì›Œí¬ì´ë‹¤. í˜ì´ì§€ëŠ” ì„œë²„ê°€ ë¡œë“œí•´ì£¼ê³ , í˜ì´ì§€ê°€ ê·¸ë ¤ì§„ ì´í›„ í˜ì´ì§€ ë‚´ë¶€ì—ì„œ ë™ì ì¸ ë°ì´í„°ë¥¼ fetchí•˜ëŠ” ê³¼ì •ì€ CSR(Client Side Rendering) ë°©ì‹ì„ ë”°ë¥¸ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ ë°ì´í„°ê°€ í•¨ê»˜ fetch ë˜ì–´ì•¼ í•˜ëŠ” ìƒí™©ì´ë¼ë©´ Next.jsâ€¦","html":"<h2 id=\"nextjsì˜-pre-rendering\" style=\"position:relative;\"><a href=\"#nextjs%EC%9D%98-pre-rendering\" aria-label=\"nextjsì˜ pre rendering permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Next.jsì˜ Pre-rendering</h2>\n<p>Next.jsëŠ” Reactë¡œ SSR(Server Side Rendering)ì„ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” í”„ë ˆì„ì›Œí¬ì´ë‹¤.</p>\n<p>í˜ì´ì§€ëŠ” ì„œë²„ê°€ ë¡œë“œí•´ì£¼ê³ , í˜ì´ì§€ê°€ ê·¸ë ¤ì§„ ì´í›„ í˜ì´ì§€ ë‚´ë¶€ì—ì„œ ë™ì ì¸ ë°ì´í„°ë¥¼ fetchí•˜ëŠ” ê³¼ì •ì€ CSR(Client Side Rendering) ë°©ì‹ì„ ë”°ë¥¸ë‹¤.</p>\n<p>ê·¸ë ‡ê¸° ë•Œë¬¸ì— <strong>í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ ë°ì´í„°ê°€ í•¨ê»˜ fetch ë˜ì–´ì•¼ í•˜ëŠ” ìƒí™©</strong>ì´ë¼ë©´ Next.jsê°€ ì œê³µí•˜ëŠ” <code class=\"language-text\">getInitialProps</code>, <code class=\"language-text\">getStaticProps</code>, <code class=\"language-text\">getStaticPath</code>, <code class=\"language-text\">getServerSideProps</code> ë¥¼ ì´ìš©í•´ ì²« ë Œë”ë§ ë•Œ ë°ì´í„°ê°€ í˜ì¹­ë  ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬í•´ ì£¼ì–´ì•¼ í•œë‹¤.</p>\n<h2 id=\"nextì—ì„œ-reduxë¥¼-ì‚¬ìš©í•˜ë ¤ë©´\" style=\"position:relative;\"><a href=\"#next%EC%97%90%EC%84%9C-redux%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A0%A4%EB%A9%B4\" aria-label=\"nextì—ì„œ reduxë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nextì—ì„œ Reduxë¥¼ ì‚¬ìš©í•˜ë ¤ë©´?</h2>\n<ul>\n<li>Next.jsì˜ Pre-renderingì„ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” <code class=\"language-text\">getInitialProps</code>, <code class=\"language-text\">getServerSideProps</code> ë“±ì—ì„œ storeì— ì ‘ê·¼í•˜ê¸° ìœ„í•´</li>\n<li>\n<p>ì„œë²„ ì¸¡ì˜ storeì™€ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì˜ storeë¥¼ í•©ì³ ì£¼ê¸° ìœ„í•´</p>\n<p><strong>next-redux-wrapper</strong> ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”í•˜ë‹¤.</p>\n</li>\n</ul>\n<br>\n<p>âœ… store/index.js</p>\n<ul>\n<li><code class=\"language-text\">HYDRATE</code> action handlerë¥¼ ê°€ì§€ê³  ìˆëŠ” ë¦¬ë“€ì„œ ìƒì„± - ì„œë²„ì¸¡ storeì˜ ìƒíƒœë¥¼ í´ë¼ì´ì–¸íŠ¸ ì¸¡ storeì— í•©ì³ì£¼ëŠ” ì—­í• </li>\n<li>makeStore í•¨ìˆ˜ ìƒì„±</li>\n<li>makeStore í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë°›ëŠ” createWrapper í•¨ìˆ˜ export</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">HYDRATE</span><span class=\"token punctuation\">,</span> createWrapper<span class=\"token punctuation\">,</span> MakeStore <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next-redux-wrapper'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> configureStore<span class=\"token punctuation\">,</span> combineReducers <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@reduxjs/toolkit'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> common <span class=\"token keyword\">from</span> <span class=\"token string\">'./common'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> searchSite <span class=\"token keyword\">from</span> <span class=\"token string\">'./searchRoom'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> user <span class=\"token keyword\">from</span> <span class=\"token string\">'./user'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> registerRoom <span class=\"token keyword\">from</span> <span class=\"token string\">'./registerRoom'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> auth <span class=\"token keyword\">from</span> <span class=\"token string\">'./auth'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> room <span class=\"token keyword\">from</span> <span class=\"token string\">'./room'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> reservation <span class=\"token keyword\">from</span> <span class=\"token string\">'./reservation'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//* redux-toolkit ì˜ combineReducers() ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ëª¨ë“ˆí™”ëœ ë¦¬ë“€ì„œ í•©ì¹œ rootReducer ìƒì„±</span>\n<span class=\"token keyword\">const</span> rootReducer <span class=\"token operator\">=</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\tcommon<span class=\"token operator\">:</span> common<span class=\"token punctuation\">.</span>reducer<span class=\"token punctuation\">,</span>\n\tuser<span class=\"token operator\">:</span> user<span class=\"token punctuation\">.</span>reducer<span class=\"token punctuation\">,</span>\n\tauth<span class=\"token operator\">:</span> auth<span class=\"token punctuation\">.</span>reducer<span class=\"token punctuation\">,</span>\n\tregisterRoom<span class=\"token operator\">:</span> registerRoom<span class=\"token punctuation\">.</span>reducer<span class=\"token punctuation\">,</span>\n\tsearchRoom<span class=\"token operator\">:</span> searchSite<span class=\"token punctuation\">.</span>reducer<span class=\"token punctuation\">,</span>\n\troom<span class=\"token operator\">:</span> room<span class=\"token punctuation\">.</span>reducer<span class=\"token punctuation\">,</span>\n\treservation<span class=\"token operator\">:</span> reservation<span class=\"token punctuation\">.</span>reducer<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> type RootState <span class=\"token operator\">=</span> ReturnType<span class=\"token operator\">&lt;</span><span class=\"token keyword\">typeof</span> rootReducer<span class=\"token operator\">></span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ìŠ¤í† ì–´ì˜ íƒ€ì… ì–»ê¸°</span>\n<span class=\"token keyword\">let</span> initialRootState<span class=\"token operator\">:</span> RootState<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//* rootReducerì— íƒ€ì…ì´ __NEXT_REDUX_WRAPPER_HYDRATE__ ì¸ ì•¡ì…˜ ì¶”ê°€ </span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">reducer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token operator\">:</span> any<span class=\"token punctuation\">,</span> action<span class=\"token operator\">:</span> any</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token constant\">HYDRATE</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>     \n        <span class=\"token comment\">// ë¹ˆ ì´ˆê¸°ìƒíƒœë¼ë©´ payload(=ì„œë²„ ì¸¡ storeì˜ state)ë¡œ ë®ì–´ì”Œì›Œì¤€ë‹¤               </span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">===</span> initialRootState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n\t\t\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n\t\t\t\t<span class=\"token operator\">...</span>action<span class=\"token punctuation\">.</span>payload<span class=\"token punctuation\">,</span>  \n\t\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token function\">rootReducer</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//* ë¦¬ë•ìŠ¤ storeë¥¼ ë¦¬í„´í•˜ëŠ” makeStore í•¨ìˆ˜ ìƒì„±</span>\n<span class=\"token keyword\">const</span> makeStore<span class=\"token operator\">:</span> MakeStore<span class=\"token operator\">&lt;</span>any<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">configureStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\t\treducer<span class=\"token punctuation\">,</span>\n\t\tdevTools<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tinitialRootState <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> store<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//* ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ë¥¼ wrapperë¡œ ë§Œë“¤ì–´ì„œ exportí•˜ê¸°</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> wrapper <span class=\"token operator\">=</span> <span class=\"token function\">createWrapper</span><span class=\"token punctuation\">(</span>makeStore<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> debug<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Next.jsë¡œ SSRì„ í•˜ê²Œ ë˜ë©´ ì‚¬ìš©ìê°€ ìš”ì²­í•  ë•Œë§ˆë‹¤ redux storeë¥¼ ìƒˆë¡œ ë§Œë“¤ê²Œ ëœë‹¤.</p>\n<p>makeStoreë¡œ í•˜ë‚˜ì˜ storeë¥¼ ë‹¤ë£¨ë„ë¡ ì„¤ì •í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ ë‹¨ì—ì„œ redux storeê°€ ì—¬ëŸ¬ê°œ ìƒì„±ë˜ëŠ” ê²ƒì„ ë°©ì§€í•œë‹¤.</p>\n<br>\n<p>âœ… pages/_app.tsx</p>\n<ul>\n<li>wrapperë¡œ HOC íŒ¨í„´ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ Appì„ ì¸ìë¡œ ì „ë‹¬ => HYDRATE action typeì„ ë°›ì„ ìˆ˜ ìˆë„ë¡ í•œë‹¤ </li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// Next 6ë²„ì „ ì´í›„ë¡œ &lt;Provider>ë¡œ ê°ì‹¸ì§€ ì•Šì•„ë„ ë˜ë„ë¡ ë°”ë€œ. </span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">app</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> pageProps <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> AppProps</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n\t\t\t</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">GlobalStyle</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n\t\t\t</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Header</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n\t\t\t</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Component</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">pageProps</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n\t\t\t</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>root-modal<span class=\"token punctuation\">'</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n\t\t</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">withRedux</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<p>í˜ì´ì§€ê°€ <code class=\"language-text\">getStaticProps</code> ë˜ëŠ” <code class=\"language-text\">getServerSideProps</code>ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©´ ì‚¬ìš©ìê°€ í•´ë‹¹ í˜ì´ì§€ë¥¼ ìš”ì²­í•  ë•Œë§ˆë‹¤ <strong>HYDRATE action</strong>ì´ ë°œìƒí•œë‹¤. </p>\n<blockquote>\n<h3 id=\"-hydrate\" style=\"position:relative;\"><a href=\"#-hydrate\" aria-label=\" hydrate permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ’¡ Hydrate?</h3>\n<p>ë„¥ìŠ¤íŠ¸ê°€ ì„œë²„ ë‹¨ì—ì„œ ë¯¸ë¦¬ pre-renderingí•œ HTML documentë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡í•œë‹¤. ê·¸ëŸ°ë° ì´ ë•Œ í´ë¼ì´ì–¸íŠ¸ê°€ ë°›ì€ ì›¹í˜ì´ì§€ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ìš”ì†Œë“¤ì´ í•˜ë‚˜ë„ ì—†ëŠ”, í´ë¦­ ë“±ì˜ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë“¤ì¡°ì°¨ë„ í•˜ë‚˜ë„ ì ìš©ë¼ ìˆì§€ ì•Šì€ ìƒíƒœì´ë‹¤. </p>\n<p>ë„¥ìŠ¤íŠ¸ ì„œë²„ê°€ pre-rendering ëœ í˜ì´ì§€ë¥¼ ë³´ë‚´ê³  ë‚˜ì„œ, ë°”ë¡œ ë¦¬ì•¡íŠ¸ê°€ ë²ˆë“¤ë§ëœ JS ì½”ë“œë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡í•œë‹¤. ê·¸ëŸ¬ë©´ ì´ JS ì½”ë“œë“¤ì´ ì´ì „ì— ë³´ë‚´ì§„ HTML DOM ìš”ì†Œ ìœ„ì—ì„œ í•œ ë²ˆ ë” ë Œë”ë§ì„ í•˜ë©´ì„œ ìê¸° ìë¦¬ë¥¼ ì°¾ì•„ê°€ ë§¤ì¹­ì´ ë˜ëŠ”ë°, ì´ë¥¼ DOM ìš”ì†Œ ìœ„ì— ë¬¼ì„ ì±„ìš°ë“¯ í•„ìš”ë¡œ í•˜ë˜ ìš”ì†Œë“¤ì„ ì±„ìš´ë‹¤ í•˜ì—¬ <strong>Hydrate</strong>ë¼ê³  ë¶€ë¥¸ë‹¤.</p>\n</blockquote>\n<p>ì´ ì•¡ì…˜ì˜ payloadëŠ” ì„œë²„ì—ì„œ static generation ë˜ëŠ” server side renderingì´ ë°œìƒí•  ë•Œ ìƒì„±í•œ stateë¥¼ ë‹´ê³  ìˆë‹¤. ê·¸ë˜ì„œ <strong>ì„œë²„ì—ì„œ ìƒì„±í•œ stateë¥¼ í´ë¼ì´ì–¸íŠ¸ ìª½ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•©ì³ì£¼ëŠ” (state reconciliation)</strong> ì—­í• ì„ í•œë‹¤.</p>\n<p>ì°¸ê³ ë¡œ í˜ì´ì§€ ë ˆë²¨ì—ì„œ <code class=\"language-text\">getServerSideProps</code> ë˜ëŠ” <code class=\"language-text\">getStaticProps</code>ë¥¼ ì‚¬ìš©í•˜ë©´ App.getInitialPropsë„ ë¬´ì¡°ê±´ ë°œìƒí•´ HYDRATE action ì´ ë‘ë²ˆ dispatchëœë‹¤. </p>\n<p>(App.getInitialProps ì§í›„ì˜ stateë¡œ í•œë²ˆ, getServerSideProps / getStaticProps ì§í›„ì˜ stateë¡œ í•œë²ˆ)</p>\n<br>\n<h2 id=\"issue1-ë¡œê·¸ì¸-ìƒíƒœ-ìœ ì§€í•˜ê¸°\" style=\"position:relative;\"><a href=\"#issue1-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%83%81%ED%83%9C-%EC%9C%A0%EC%A7%80%ED%95%98%EA%B8%B0\" aria-label=\"issue1 ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€í•˜ê¸° permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Issue1. ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€í•˜ê¸°</h2>\n<p>í´ë¼ì´ì–¸íŠ¸ ì¸¡ storeëŠ” ê° í˜ì´ì§€ë¥¼ ìš”ì²­í•  ë•Œë§ˆë‹¤ ì´ˆê¸°í™”ë˜ë¯€ë¡œ, ëª¨ë“  í˜ì´ì§€ì—ì„œ ë¡œê·¸ì¸í•œ ìœ ì € ì •ë³´ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆë„ë¡ <strong>_app.tsx</strong>ì—ì„œ <code class=\"language-text\">getInitialAppProps</code>ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.</p>\n<p>ì¿ í‚¤ì— access_tokenì´ ìˆë‹¤ë©´ ë¡œê·¸ì¸í•œ ìœ ì € ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” apië¥¼ í˜¸ì¶œí•˜ê³ , ë°›ì€ ë°ì´í„°ë¥¼ storeì— ì €ì¥í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€í•˜ì—¬ ëª¨ë“  í˜ì´ì§€ ìš”ì²­ì‹œë§ˆë‹¤ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ë‹¤. </p>\n<p>âš¡ next-redux-wrapper ê°€ 7ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ë©´ì„œ  <code class=\"language-text\">getInitialProps</code>ë¥¼ í•´ë‹¹ ìƒí™©ì— ì ì ˆí•œ wrapperë¡œ ê°ì‹¸ì¤˜ì•¼ í•œë‹¤ :  <code class=\"language-text\">wrapper.getInitialAppProps</code> ë˜ëŠ” <code class=\"language-text\">wrapper.getInitialPageProps</code>ë¥¼ ì‚¬ìš©í•œë‹¤.</p>\n<p>âš¡ ë˜í•œ <code class=\"language-text\">({store, req, res, ...}) =&gt; { ... }</code> ì—ì„œ <code class=\"language-text\">store =&gt; ({req, res, ...}) =&gt; { ... }</code> ì™€ ê°™ì´ í•¨ìˆ˜ ì‚¬ìš©ë²•ì´ ë°”ë€Œì—ˆë‹¤.</p>\n<p>ì²˜ìŒì— ì´ê±° ëª°ë¼ì„œ ê³ ìƒ ë§ì´í•¨â€¦</p>\n<p>âœ… pages/_app.tsx</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> App<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> AppProps <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/app'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'../lib/api'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Header <span class=\"token keyword\">from</span> <span class=\"token string\">'../components/Header'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> GlobalStyle <span class=\"token keyword\">from</span> <span class=\"token string\">'../styles/GlobalStyle'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> wrapper <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../store'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> cookieStringToObject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../lib/utils'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> meAPI <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../lib/api/auth'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> userActions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../store/user'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">app</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> pageProps <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> AppProps</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n\t\t<span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n\t\t\t<span class=\"token operator\">&lt;</span>GlobalStyle <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n\t\t\t<span class=\"token operator\">&lt;</span>Header <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n\t\t\t<span class=\"token operator\">&lt;</span>Component <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>pageProps<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n\t\t\t<span class=\"token operator\">&lt;</span>div id<span class=\"token operator\">=</span><span class=\"token string\">'root-modal'</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n\t\t<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span>getInitialProps <span class=\"token operator\">=</span> wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">getInitialAppProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">store</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">context</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> appInitialProps <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> App<span class=\"token punctuation\">.</span><span class=\"token function\">getInitialProps</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> cookieObject <span class=\"token operator\">=</span> <span class=\"token function\">cookieStringToObject</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span>req<span class=\"token operator\">?.</span>headers<span class=\"token punctuation\">.</span>cookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> isLogged <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isLogged <span class=\"token operator\">&amp;&amp;</span> cookieObject<span class=\"token punctuation\">.</span>access_token<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\taxios<span class=\"token punctuation\">.</span>defaults<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">.</span>cookie <span class=\"token operator\">=</span> cookieObject<span class=\"token punctuation\">.</span>access_token<span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">meAPI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tstore<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>userActions<span class=\"token punctuation\">.</span><span class=\"token function\">setLoggedUser</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>appInitialProps <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">withRedux</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"issue2-ë¡œê·¸ì¸í•œ-ì‚¬ìš©ìì˜-ì˜ˆì•½-ë‚´ì—­-ê°€ì ¸ì˜¤ê¸°\" style=\"position:relative;\"><a href=\"#issue2-%EB%A1%9C%EA%B7%B8%EC%9D%B8%ED%95%9C-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%9D%98-%EC%98%88%EC%95%BD-%EB%82%B4%EC%97%AD-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\" aria-label=\"issue2 ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì˜ˆì•½ ë‚´ì—­ ê°€ì ¸ì˜¤ê¸° permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Issue2. ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì˜ˆì•½ ë‚´ì—­ ê°€ì ¸ì˜¤ê¸°</h2>\n<p>ë¡œê·¸ì¸ëœ ì‚¬ìš©ìì˜ user idë¥¼ ê°€ì ¸ì˜¤ê³ , í•´ë‹¹ user idì˜ ì˜ˆì•½ ë‚´ì—­ì„ ê°€ì ¸ì™€ì„œ redux storeì— ì €ì¥í•˜ê³ , ì»´í¬ë„ŒíŠ¸ì—ì„œ storeì— ì €ì¥ëœ ê°’ì„ ì‚¬ìš©í•´ì„œ ë Œë”ë§ì„ í•´ì£¼ê³  ì‹¶ì—ˆë‹¤.</p>\n<p>ì²˜ìŒì—ëŠ” í˜ì´ì§€ì—ì„œ <code class=\"language-text\">getServerSideProps</code>ë¥¼ ì‚¬ìš©í•˜ë ¤ê³  í–ˆë‹¤. ê·¸ëŸ°ë° <code class=\"language-text\">getServerSideProps</code> í•¨ìˆ˜ ë‚´ì—ì„œ ë³´ë‚¸ dispatchê°€ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ìƒíƒœì— ë°˜ì˜ì´ ì•ˆ ë˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤â€¦</p>\n<br> \n<p>âœ… pages/reservation/index.tsx</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NextPage <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ReservationMain <span class=\"token keyword\">from</span> <span class=\"token string\">'../../components/reservation/ReservationMain'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> wrapper <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../store'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> getUserReservationAPI <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../lib/api/reservations'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> reservationActions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../store/reservation'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> cookieStringToObject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../lib/utils'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'../../lib/api'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> index<span class=\"token operator\">:</span> <span class=\"token function-variable function\">NextPage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>ReservationMain <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> getServerSideProps <span class=\"token operator\">=</span> wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">getServerSideProps</span><span class=\"token punctuation\">(</span>\n \t<span class=\"token punctuation\">(</span><span class=\"token parameter\">store</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n \t\t<span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>etc <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n \t\t\t<span class=\"token keyword\">const</span> userId <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n \t\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n \t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n \t\t\t\t\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getUserReservationAPI</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \t\t\t\t\tstore<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>reservationActions<span class=\"token punctuation\">.</span><span class=\"token function\">setUserReservations</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \t\t\t\t<span class=\"token punctuation\">}</span>\n \t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n \t\t\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \t\t\t<span class=\"token punctuation\">}</span>\n \t\t<span class=\"token punctuation\">}</span>\n <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> index<span class=\"token punctuation\">;</span></code></pre></div>\n<p>(HYDRATE Actionì— Payloadë¡œ ë“¤ì–´ê°„ ê²ƒê¹Œì§„ í™•ì¸ë¨)</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1041px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 71.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVQ4y41Ty27TQBT1PyPBr3TFGoEACcSGfbsDCbViUSltQuRH/LbHsefh8eHcSapCVSUd5XjGvnfOPfeRaPXzGpttjCRJ0DRNQNu2AXJWSv2Hvu8D5DwMA9I0xWq1wnq9xna7RVReXiHJMpRliaauUVUVuq4LF4qiOHw/BhKIPY5j1PR98Nvv90GA2CI1TXi6lmUJjiMd5XKWpSTOiR3yPKOaeypLAqmQlGUVdgkYVWURXg6GMjhNDJJRtXzr+45KBqoAjAGcO8AYT0yEhtaGuwkliESqkDxAoozjeKxlQyKNea6o7IL2C9q+kfCWefT/5hSeWmtEOLHm2VKhZQmuGeANmvY1CV9h9h9o/USar9wV7QfSQCj1eg6ynLNMg3niD5gVqlqC8NXzNwt+w7u3WPzdUeF4htAaNkfzdI9BpaEZOzbF9DV0y1rXGiMbZcd3Qgc92edTflToSNjxtGYtexJuUOQ7TGyU4SyavoFRDt4n9LmlwuUcoWfKO55W7OISuujYVcs9EHK07LAnIUcAMee2PU1oradCIdywGRZqUMd+PvHHyOeW/7biJQrzEH2aHIc55ruCG0XZIW3dLVR9F8qS52cUuqBQCG+4W2w2CbJdC61mmIFtkOZ0N7D6veTDLPRpwmWZw5h4f8ka/uIFpj79gJu/wy8fic/EFyINszh7h7+EwTgKT7XksgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"1\" title=\"1\" src=\"/static/db22be285d82f3be3e6aab3cfb155422/ee9b6/1.png\" srcset=\"/static/db22be285d82f3be3e6aab3cfb155422/5a46d/1.png 300w,\n/static/db22be285d82f3be3e6aab3cfb155422/0a47e/1.png 600w,\n/static/db22be285d82f3be3e6aab3cfb155422/ee9b6/1.png 1041w\" sizes=\"(max-width: 1041px) 100vw, 1041px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>(í•˜ì§€ë§Œ Stateì— ë°˜ì˜ ì•ˆë¨â€¦ ì™¤ê¹Œâ€¦?)</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1041px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 86.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACOklEQVQ4y51Uy27bMBDU/x977r0fkUPhSy5Fz0US11FsS6LeFknJD1me7qwiw04TBwiBAUVqOdxd7mzwnKQwWQ6TZiirWpEVJYqyUmRFgfx1Pc1ZUeE5ylFUDeK0wJ/5C8IwRBQnCP7e/cTD4xzr9RpZlglSlGWJuq6RpimstfDewzkHL+C6qio01st+i0psTZIgjmPlCJqnRzVu2xa73Q7b7VbRdZ3uJ2JciJe8hPP0naYGy+VSL95sNnoJ9wMnJMMw4HQ6XWHyjF4aY5SIhwn+G0lTNE1zBomDIs8RRRHWq5WCrtNbzjzAbxJXdYXDocfxOAiOZyc4c83vtu0QMExiv99fgXsMm4SE0Xx2SvjR4JkAN8YgN9M7hkhveRHH2/QQHFsSvvdzMuj7fnwseSTm0TovIf5vN80feviW0AnRYrGQOjNo/f71/xcIj8deQ+66LRxfvfXoJQ2XYV/aa9ncJOx7LV7vrXjZ4DTwQfiifGG1vLKPpWY/zaH3VMceRb6VcOWhBijZSHo6lw4H8/wJ4UFyeJDczJDn36Vwf4in3+T//N2qoKpulg0Llg/iXCRePgl+Ce507dwozUm2HKoUJpIbrDWCBk1jxaMcuXQhajYM16JbI+qpBI0oyyA1saqJoNJms5meCegmhW0v9FiLzCaxj+IfYW2jj+OcxUu80VbHM7S7v78fQ14uRcNyw4ZkgkT6W7gyY9+TG8uKfZGNYOyX1koEEsnvB+kBJtemkUkktTiSJAb/AFUJHYN/4BfaAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"2\" title=\"2\" src=\"/static/f4b053c642b0cf23ae5a992e6fa5ecda/ee9b6/2.png\" srcset=\"/static/f4b053c642b0cf23ae5a992e6fa5ecda/5a46d/2.png 300w,\n/static/f4b053c642b0cf23ae5a992e6fa5ecda/0a47e/2.png 600w,\n/static/f4b053c642b0cf23ae5a992e6fa5ecda/ee9b6/2.png 1041w\" sizes=\"(max-width: 1041px) 100vw, 1041px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>createWrapper ì— {debug : true}ë¡œ ì„¤ì •í•˜ê³  ì½˜ì†”ì— ì°íŒ ê²°ê³¼ë¥¼ ë³´ë©´.. initialStateFromGSPorGSSR ì´ë¼ëŠ” ê³³ì— ë“¤ì–´ê°€ ìˆëŠ”ë° ì´ê±¸ ì–´ë””ì„œ ì–´ë–»ê²Œ í™œìš©í•  ìˆ˜ ìˆëŠ”ì§€ ì˜ ëª¨ë¥´ê² ë‹¤â€¦</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 510px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 98%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADpUlEQVQ4y5VUz4scRRidf1ASBUMgq0nA5KaI4FFhNyBeAh4MkeQmChKjFw/qRRQR48HLYnazO5ndmUn/7uqurv5d3V39fNUzG1fiITY8qqqn+pvvve993yyOYyydJU7cAE0zIo5TZJmEynNIpZCm3KscQRAiSQRikaAsSyRc7W9xFMHG0FpjMAazyPsey8NXsT7ZgQo+wDDUmJ6hB8yA/3rGcYQhxi0MA9m17wfM2lYiWR5DhU+Ywc8I/DVUplA6DlQkUTcdXvbp+x6zptFwH/vwDgT8pyVEoBBFyUTR9wXCYEOx5b2iKFAWJcZhQFVWlKhB33XIKYkNNvD9rOs7ZEGGeLEk/kIpFtCli66rSWXk/5qJkt1vVnOOpnmRsv0kjX7As/1X4B9dgnf4OoL5JQp9gRcebcmYFzQ8dzhHmQH73iCLV8jSOTWMWbkMSRrhmfMn9ROoqKEmlbptMb6MhlWl4R+WCOcawbJm0Baem0BEOao4Qbxew58fQ/ghilRNNonCEEJkPEtInq3eWncbDdvWRxp+B5k8oLe+pcC/stK/Q6YBDIvRJQk0PzJVhaGuJ781XOu6wWCLYvdcbbApYJb8Bu/JDUSn78M5fhvO0VVEJ28i2L+IWi7wf56JMjOFWLaQHqudGYS+mrogcx9DeD4zLfjPmpW0lNoJ49ht3/UYzSaz51Wum4oe9OEfZHCJTLBIaoRIDAvUM2BPH4I+BH0I+pCFZQNVfNewqXqNrQ/1hjIthFwcIDy6Rx/ehXTuo4y/RNv+xEt/kIi1zkPiE+IW8RFxh/iC+IXwzlHuMLMbGX1MD76HaHUX8eozeE/3EIbvwvNeY5ZXWYBdZnOPWX3NtvwcZfUp+nIPWryFTl6ATnZg+n2Q8SZgp++jUrd5+SGq9htOl6+Q5z8yyD7fzaltRloKUga0jINUsvqyR72iXQL2u3OH1Hc5bc4Cdrzk30Li7zKjPdTVh8iLdxjgDepynTeuEdcpvMU1Yocmv7I93yQuE49ImQEHjikpCqQCbDfDDOxMHLFaK2Y50Hdselazs+o/7xW7Z1VQETFR/2Mba8poQSoLF8HKZVZ2wjiEhzrn0GAXRLSPiFLUZYtM0gkyR1F2qIsaivRTdpAtyLZTWggnZj+nEHZaS8VO8ZFTtz5N0LguytNTaiahOSeLImcQthz3mlO9pbaZUtvxxYmteLC9GQYBezKgqQWWy1NeyieCdqyb8d+j62xkme3kPvut63r8DS2T5Y+G5ERCAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"3\" title=\"3\" src=\"/static/5b8e1b0f39b86356d31049ceb264415b/0abdd/3.png\" srcset=\"/static/5b8e1b0f39b86356d31049ceb264415b/5a46d/3.png 300w,\n/static/5b8e1b0f39b86356d31049ceb264415b/0abdd/3.png 510w\" sizes=\"(max-width: 510px) 100vw, 510px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<br>\n<p>ê·¸ë˜ì„œ serverSideProps ëŒ€ì‹ ì— <code class=\"language-text\">getInitialPageProps</code>ë¥¼ ì‚¬ìš©í•´ë³´ë ¤ê³  í•˜ë‹ˆ, user idë¥¼ ë°›ì•„ì˜¤ëŠ” ê²Œ ë¬¸ì œì˜€ë‹¤. pageì˜ getInitialPageProps ê°€ _appì˜ getInitialPropsë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ë¼ì„œ ì•„ì§ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ê°€ storeì— ë“¤ì–´ê°€ì§€ë„ ì•Šì€ ì‹œì ì—ì„œ ì ‘ê·¼í•´ë²„ë¦°ë‹¤. </p>\n<p>ê·¸ë˜ì„œ.. ì–´ì©” ìˆ˜ì—†ì´ ì—¬ê¸°ì—ì„œë„ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” apië¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì¼ë‹¨ í•´ê²°ì€ í–ˆëŠ”ë° ã…  ì´ê²Œ ë§ëŠ” ë°©ë²•ì¸ì§€ ëª¨ë¥´ê² ë‹¤. </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">index<span class=\"token punctuation\">.</span>getInitialProps <span class=\"token operator\">=</span> wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">getInitialPageProps</span><span class=\"token punctuation\">(</span>\n\t<span class=\"token punctuation\">(</span><span class=\"token parameter\">store</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n\t\t<span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>etc <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token comment\">// const userId = store.getState().user.id;  ë¶ˆê°€</span>\n\t\t\t<span class=\"token keyword\">const</span> cookieObject <span class=\"token operator\">=</span> <span class=\"token function\">cookieStringToObject</span><span class=\"token punctuation\">(</span>req<span class=\"token operator\">?.</span>headers<span class=\"token punctuation\">.</span>cookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> isLogged <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isLogged <span class=\"token operator\">&amp;&amp;</span> cookieObject<span class=\"token punctuation\">.</span>access_token<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\taxios<span class=\"token punctuation\">.</span>defaults<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">.</span>cookie <span class=\"token operator\">=</span> cookieObject<span class=\"token punctuation\">.</span>access_token<span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token comment\">// ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ í˜¸ì¶œ</span>\n                    <span class=\"token keyword\">const</span> userRes <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">meAPI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token keyword\">const</span> userId <span class=\"token operator\">=</span> userRes<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n\t\t\t\t\t\n                    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getUserReservationAPI</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\tstore<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>reservationActions<span class=\"token punctuation\">.</span><span class=\"token function\">setUserReservations</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ğŸ’› í”¼ë“œë°±ê³¼ ì¡°ì–¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤ ğŸ’›</p>\n<hr>\n<p>ì°¸ê³ ìë£Œ</p>\n<p><a href=\"https://github.com/kirill-konshin/next-redux-wrapper\">https://github.com/kirill-konshin/next-redux-wrapper</a></p>\n<p><a href=\"https://helloinyong.tistory.com/315\">https://helloinyong.tistory.com/315</a></p>","tableOfContents":"<ul>\n<li><a href=\"/Next.js/next-redux-wrapper/#nextjs%EC%9D%98-pre-rendering\">Next.jsì˜ Pre-rendering</a></li>\n<li><a href=\"/Next.js/next-redux-wrapper/#next%EC%97%90%EC%84%9C-redux%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A0%A4%EB%A9%B4\">Nextì—ì„œ Reduxë¥¼ ì‚¬ìš©í•˜ë ¤ë©´?</a></li>\n<li><a href=\"/Next.js/next-redux-wrapper/#issue1-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%83%81%ED%83%9C-%EC%9C%A0%EC%A7%80%ED%95%98%EA%B8%B0\">Issue1. ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€í•˜ê¸°</a></li>\n<li><a href=\"/Next.js/next-redux-wrapper/#issue2-%EB%A1%9C%EA%B7%B8%EC%9D%B8%ED%95%9C-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%9D%98-%EC%98%88%EC%95%BD-%EB%82%B4%EC%97%AD-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\">Issue2. ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì˜ˆì•½ ë‚´ì—­ ê°€ì ¸ì˜¤ê¸°</a></li>\n</ul>","frontmatter":{"title":"[Next.js] next-redux-wrapper ì‚¬ìš©í•˜ê¸°","date":"February 07, 2022"}}},"pageContext":{"slug":"/Next.js/next-redux-wrapper/","previous":{"fields":{"slug":"/JavaScript/2-ë¸Œë¼ìš°ì €ë Œë”ë§/"},"frontmatter":{"title":"ë¸Œë¼ìš°ì € ë Œë”ë§"}},"next":null}}}