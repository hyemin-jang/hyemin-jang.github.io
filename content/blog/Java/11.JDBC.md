---
title: '[Java] 11. JDBC'
date: 2021-08-19 10:08:19
category: 'Java'
thumbnail: { thumbnailSrc }
draft: false
---

# 1. JDBC

**Java DataBase Connectivity**

: ìë°” ì–¸ì–´ë¡œ ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ DBì— ì ‘ì†í•˜ê³  SQLë¬¸ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” í‘œì¤€ API. 

ìë°” í”„ë¡œê·¸ë¨ê³¼ DBMSê°„ì˜ í†µì‹ ì„ ì¤‘ê°„ì—ì„œ ë²ˆì—­í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤ê³  ë³´ë©´ ëœë‹¤.

![â–·â–· Javaì˜ JDBC: ì‹œì‘í•˜ê¸° ì „ì— ì•Œì•„ì•¼ í•  5ê°€ì§€ : ë„¤ì´ë²„ ë¸”ë¡œê·¸](https://mblogthumb-phinf.pstatic.net/MjAyMDAxMDJfMTg4/MDAxNTc3OTQzMjEyMzU5.1-BQvmFTERWB6oyQZEHjljFNNgnK7PG8V7LWkTFJsDEg.yG2CXl-m3a5uOrfuLh40_q_4rl-aAqXIsAQm_LAeCx0g.PNG.ki630808/jdbcjava1.PNG?type=w800)





## 1) JDBC ì¸í„°í˜ì´ìŠ¤

: JDBC í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ê¸° ìœ„í•œ APIë“¤. java.sql íŒ¨í‚¤ì§€ ë‚´ì— ìˆëŠ” ì£¼ìš” APIë“¤ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- `java.sql.Driver`
  - DB ë²¤ë”ì— ë§ëŠ” ë“œë¼ì´ë²„ë¥¼ í˜¸ì¶œí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤

- `java.sql.Connection`
  - íŠ¹ì • DBì™€ì˜ ì—°ê²° ì •ë³´ë¥¼ ê°€ì§€ëŠ” ì¸í„°í˜ì´ìŠ¤
  - DriverManagerë¡œë¶€í„° Connection ê°ì²´ë¥¼ ê°€ì ¸ì˜¨ë‹¤
- `java.sql.Statement`
  - SQL ì¿¼ë¦¬ë¬¸ì„ DBì— ì „ì†¡í•˜ëŠ” ë°©ë²•ì„ ì •ì˜í•œ ì¸í„°í˜ì´ìŠ¤
- `java.sql.PreparedStatement`
  - Statementì˜ í•˜ìœ„ ì¸í„°í˜ì´ìŠ¤
  - SQLë¬¸ì„ ë¯¸ë¦¬ ì»´íŒŒì¼í•˜ì—¬ ì‹¤í–‰ ì†ë„ë¥¼ ë†’ì„
- `java.sql.ResultSet`
  - SELECT êµ¬ë¬¸ ì‹¤í–‰ ê²°ê³¼ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì •ì˜í•œ ì¸í„°í˜ì´ìŠ¤



## 2) JDBC Driver

:  ìë°” í”„ë¡œê·¸ë¨ì˜ ìš”ì²­ì„ ê° DBMSê°€ ì´í•´í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ìë°” í´ë˜ìŠ¤ íŒŒì¼

- java.sqlì˜ ì¸í„°í˜ì´ìŠ¤ë“¤ì€ í‘œì¤€í™”ë¥¼ ìœ„í•œ í‹€ ì—­í• ë§Œ ì œê³µí•˜ê³ ,  **JDBC Driverê°€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†í•˜ì—¬ ì¬ì •ì˜**í•¨ìœ¼ë¡œì¨  ì‹¤ì œ ë©”ì†Œë“œ ëª¸ì²´ë¥¼ êµ¬í˜„í•œë‹¤.

- ê° DB ë²¤ë”ì‚¬ê°€ JDBC Driverë¥¼ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ê°œë°œìëŠ” ì§ì ‘ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¬ì •ì˜í•  í•„ìš” ì—†ì´ ê°€ì ¸ë‹¤ ì“°ê¸°ë§Œ í•˜ë©´ ëœë‹¤.

  > ì˜¤ë¼í´: oracle.jdbc.driver.OracleDriver
  >
  > MySQL: com.mysql.jdbc.Driver 
  >
  > MariaDB: org.mariadb.jdbc.Driver  ë“±ë“±

### ğŸ’ ì´í´ë¦½ìŠ¤ì—ì„œ JDBC ë“œë¼ì´ë²„ ì‚¬ìš©í•˜ê¸° - Oracle11g XE ê¸°ì¤€

1. ì˜¤ë¼í´ì´ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤ë©´ ì˜¤ë¼í´ ë“œë¼ì´ë²„ jaríŒŒì¼(=ìë°” ì‹¤í–‰íŒŒì¼)ë„ ì´ë¯¸ ê°€ì§€ê³  ìˆë‹¤. ì˜¤ë¼í´ì´ ì„¤ì¹˜ëœ ë””ë ‰í† ë¦¬ë¡œ ê°€ì„œ `oraclexe\app\oracle\product\11.2.0\server\jdbc\lib` ê²½ë¡œë¡œ ì°¾ì•„ê°€ë³´ë©´ **odbc6.jar** íŒŒì¼ì´ ìˆë‹¤(jdk1.8 ì´ìƒì—ì„œ ì‚¬ìš©). ì´ íŒŒì¼ì„ ì›í•˜ëŠ” ìœ„ì¹˜ì— ë³µì‚¬í•´ë‘”ë‹¤.
2. ìë°” í”„ë¡œì íŠ¸ë¥¼ ìš°í´ë¦­í•˜ì—¬ Build Path - Add Libraries í†µí•´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•œë‹¤.

![image-20210820191216912](C:\Users\hmjan\Desktop\ì´ë¯¸ì§€\image-20210820191216912.png)



User Library ì„ íƒ

![image-20210821002548746](C:\Users\hmjan\AppData\Roaming\Typora\typora-user-images\image-20210821002548746.png)

3. Newë¥¼ ëˆŒëŸ¬ ìƒˆë¡œìš´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•œ ë’¤, **Add External JARs**ë¥¼ ëˆ„ë¥´ê³  ì•„ê¹Œ ë³µì‚¬í•´ë’€ë˜ **odbc6.jar**ë¥¼ ì¶”ê°€í•œë‹¤.  Apply and Closeë¥¼ ëˆŒëŸ¬ ë“±ë¡ ì™„ë£Œí•œë‹¤.

![image-20210821002300277](C:\Users\hmjan\Desktop\ì´ë¯¸ì§€\image-20210821002300277.png)

4. íŒ¨í‚¤ì§€ í•˜ë‹¨ì— ì´ë ‡ê²Œ odbc6.jarê°€ ì •ìƒ ë“±ë¡ë˜ì–´ ìˆë‹¤ë©´ ì´ì œ ì´í´ë¦½ìŠ¤ì—ì„œ oracle JDBC Driverë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

![image-20210821002851211](C:\Users\hmjan\AppData\Roaming\Typora\typora-user-images\image-20210821002851211.png)





## 3)  JDBC í”„ë¡œê·¸ë˜ë° 

JDBCë¥¼ ì´ìš©í•œ í”„ë¡œê·¸ë¨ì€ ë‹¤ìŒê³¼ ê°™ì€ íë¦„ìœ¼ë¡œ êµ¬ì„±ëœë‹¤.

1. íŠ¹ì • DBì— ì ‘ì†í•˜ëŠ” ê°ì²´ ìƒì„±

   ```java
   Connection con = DriverManager.getConnection
       			 ("jdbc:oracle:thin:@127.0.0.1:1521:xe", "SCOTT", "TIGER");
   ```

   - getConnection ë©”ì†Œë“œì˜ ì¸ìê°’
     - String url : ì ‘ì†í•  ì„œë²„ì˜ URLì´ë‹¤. í”„ë¡œí† ì½œ (jdbc:) , ì„œë²„ì£¼ì†Œ(127.0.0.1 = ë¡œì»¬ì„œë²„ë¼ëŠ” ëœ»), ì„œë²„ í¬íŠ¸(1521), DBì´ë¦„(xe)ìœ¼ë¡œ êµ¬ì„±ëœë‹¤. 
     - String user : DB ë¡œê·¸ì¸ ê³„ì •
     - String password : DB ë¡œê·¸ì¸ ë¹„ë°€ë²ˆí˜¸

   âš¡ DBì ‘ì† ê´€ë ¨ ì •ë³´ê°€ ì½”ë“œì— ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ propertiesíŒŒì¼ì— ë”°ë¡œ ì €ì¥ ê¶Œì¥

   ```java
   private static Properties dbinfo = new Properties();
   	
   	// static ë¸”ë¡ì„ ì‚¬ìš©í•´ í”„ë¡œê·¸ë¨ ì‹¤í–‰ì‹œ ë”± í•œë²ˆë§Œ ë¡œë”©í•´ì„œ ë©”ëª¨ë¦¬ì— ì €ì¥
   	static {
   		try {
   			dbinfo.load(new FileInputStream("dbinfo.properties"));
   		} catch (IOException e) {
   			e.printStackTrace();
   		}
   	}
   	
   	public static Connection getConnection() throws SQLException {  
   		return DriverManager.getConnection(dbinfo.getProperty("jdbc.url"), 	
                                              dbinfo.getProperty("jdbc.id"), 
                                              dbinfo.getProperty("jdbc.pw"));	
   	}
   ```

   <dbinfo.properties íŒŒì¼>

   ```properties
   #db.properties
   jdbc.driver=oracle.jdbc.driver.OracleDriver
   jdbc.url=jdbc:oracle:thin:@127.0.0.1:1521:xe
   jdbc.id=SCOTT
   jdbc.pw=TIGER
   ```

   

2. SQL ë¬¸ì¥ ì‹¤í–‰ ê°€ëŠ¥í•œ ê°ì²´ ìƒì„±

   ```java
   Statement stmt = con.createStatement();
   ```

   

3. SQL ë¬¸ì¥ ì‹¤í–‰

   ```java
   // deptí…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” selectë¬¸ ì‹¤í–‰
   ResultSet rset = stmt.executeQuery("select * from dept")
   ```

   - SQLë¬¸ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ Statement ê°ì²´ì—ì„œ ì œê³µí•˜ëŠ” ë©”ì†Œë“œ

     - `executeQuery` : selectë¬¸ ì‹¤í–‰í•˜ì—¬ ResultSet ê°ì²´ ë°˜í™˜
     - `ResultSet` : selectí•œ ë°ì´í„°ì§‘í•©ì„ ê°€ì§€ëŠ” ê°ì²´
     - `executeUpdate` : insert, update, deleteë¬¸ ì‹¤í–‰

     

4. ê²°ê³¼ í™œìš©

   ```java
   // selectí•œ ê²°ê³¼ ì¶œë ¥
   while(rset.next()) {
   	System.out.println(rset.getInt("deptno") + "/" + rset.getString("dname") + "/" 
                          + rset.getString("loc"));
   }
   ```

   - í˜„ì¬ resultSet ê°ì²´ rsetì´ ê°€ì§€ê³  ìˆëŠ” ê°’ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

   | ì»¤ì„œ | deptno | dname | loc  |           |
   | ---- | ------ | ----- | ---- | --------- |
   | `â†’`  |        |       |      | ì‹œì‘ ë¹ˆí–‰ |
   |      | 10     | a     | aa   |           |
   |      | 20     | b     | bb   |           |
   |      |        |       |      | ë ë¹ˆí–‰   |

   - ResultSet ê°ì²´ì˜ ë©”ì†Œë“œ

     - boolean next() 

       : ì»¤ì„œ ë‹¤ìŒì— ë ˆì½”ë“œê°€ ìˆëŠ”ì§€ íŒë‹¨í•˜ì—¬ ì—†ìœ¼ë©´ false, ìˆìœ¼ë©´ trueë¥¼ ë°˜í™˜í•œ ë‹¤ìŒì— ì»¤ì„œë¥¼ ë‹¤ìŒ ë ˆì½”ë“œë¡œ ì´ë™ì‹œí‚´

     - Int getInt(int columnIndex / String columnLabel)  / 

       String getString(int columnIndex / String columnLabel)

       : í˜„ì¬ ì»¤ì„œê°€ ê°€ë¦¬í‚¤ëŠ” ë ˆì½”ë“œì˜ ì»¬ëŸ¼ ê°’ì„ ë°ì´í„° íƒ€ì…ì— ë”°ë¼ ì¶”ì¶œ. íŒŒë¼ë¯¸í„°ë¡œ ì»¬ëŸ¼ ì¸ë±ìŠ¤ ë˜ëŠ” ì»¬ëŸ¼ëª… ì‚¬ìš© ê°€ëŠ¥. 

       

5. ìì› ë°˜í™˜

   ```java
   // ë°˜í™˜ ìˆœì„œ - ê°€ì¥ ìµœê·¼ì— ì‚¬ìš©í•œ ê°ì²´ë¶€í„°
   rset.close()
   stmt.close()
   con.close()
   ```

   

-----------------------------------



# 2. DAO Pattern

: **Data Access Object** Pattern

- DB ì—°ë™ í´ë˜ìŠ¤ë¥¼ ì •í˜•í™”í•´ì„œ ê°œë°œí•˜ê²Œ í•˜ëŠ” êµ¬ì¡°

- ì¼ë°˜ì ìœ¼ë¡œ í•œ í…Œì´ë¸” ë‹¹ í•˜ë‚˜ì˜ DAO í´ë˜ìŠ¤ë¥¼ ê°œë°œí•¨
- ê° DAO í´ë˜ìŠ¤ëŠ” CRUD ê¸°ëŠ¥ì„ ì‹¤í–‰í•´ì£¼ëŠ” ë©”ì†Œë“œ ì œê³µ

### ğŸ’¡ DAOì—ì„œ Connectionì— ì ‘ê·¼í•˜ëŠ” ë°©ì‹

1. DAO í´ë˜ìŠ¤ ë‚´ ë©”ì†Œë“œì—ì„œ ì§ì ‘ Connection ìƒì„±

   => ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ë§¤ë²ˆ ì»¤ë„¥ì…˜ ìƒì„± ë° ìì›ë°˜í™˜ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤ => ì¤‘ë³µ ì½”ë“œë¡œ ë¹„íš¨ìœ¨ì 

2. Connection ìƒì„± ë° ìì›ë°˜í™˜ë§Œ ë‹´ë‹¹í•˜ëŠ” Util í´ë˜ìŠ¤ ë”°ë¡œ ê°œë°œí•˜ê³  DAO í´ë˜ìŠ¤ ë‚´ ë©”ì†Œë“œì—ì„œ ê°€ì ¸ë‹¤ ì“°ê¸°

   âš¡ Util í´ë˜ìŠ¤ ê°œë°œ ì˜ˆ : 

   ```java
   package util;
   
   import java.sql.Connection;
   import java.sql.DriverManager;
   import java.sql.ResultSet;
   import java.sql.SQLException;
   import java.sql.Statement;
   
   public class DBUtil {   
       
   	public static Connection getConnection() throws SQLException { 
       // throws SQLEXception : DBì ‘ì† ì •ë³´ì— ê´€í•œ ì—ëŸ¬ëŠ” ì‚¬ìš©ìê°€ ì•Œì•„ì•¼ í•˜ëŠ” ì •ë³´
       // ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•œ ìœ„ì¹˜ë¡œ throw
   		return DriverManager.getConnection(
               	"jdbc:oracle:thin:@127.0.0.1:1521:xe", "SCOTT", "TIGER");	
   	}
   
   	public static void close(Connection con, Statement stmt, ResultSet rset) {
   		try {
   			if(rset != null) {    
   				rset.close();
   				rset = null;
   			}
   			if(stmt != null) {
   				stmt.close();
   				stmt = null;
   			}
   			if(con != null) {				
   				con.close();
   				con = null;					
   			} 
   		}catch (SQLException e) {   
   				e.printStackTrace();	
            // ìì› ë°˜í™˜ì— ê´€ë ¨ëœ ì—ëŸ¬ì— ê´€í•œ ë‚´ìš©ì€ ì‚¬ìš©ìê°€ ì•Œ í•„ìš” ì—†ìœ¼ë¯€ë¡œ í˜„ ìœ„ì¹˜ì—ì„œ catch
   		}
   	}
   	
       // selectìš© ìì›ë°˜í™˜ ë©”ì„œë“œ
       public static void close(Connection con, Statement stmt, ResultSet rset) {
   		try {
   			if(rset != null) {    
   				rset.close();
   				rset = null;
   			}
   			if(stmt != null) {
   				stmt.close();
   				stmt = null;
   			}
   			if(con != null) {				
   				con.close();
   				con = null;					
   			} 
   		}catch (SQLException e) {   
   				e.printStackTrace();				
   		}
   	}
       
       // insert, update, deleteìš© ìì›ë°˜í™˜ ë©”ì„œë“œ
   	public static void close(Connection con, Statement stmt) {
   		try {				
   			if(stmt != null) {
   				stmt.close();
   				stmt = null;
   			}
   			if(con != null) {				
   				con.close();
   				con = null;						
   			} 
   		}catch (SQLException e) {
   				e.printStackTrace();				
   		}
   	}
   
   }
   ```

   

 