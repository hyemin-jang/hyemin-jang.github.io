---
title: '[WEB] í™”ë©´ì´ë™ê³¼ ìƒíƒœìœ ì§€ ê¸°ë²•'
date: 2021-08-31 13:08:79
category: 'TIL - Playdata'
thumbnail: { thumbnailSrc }
draft: false
---



## í™”ë©´ì´ë™ ê¸°ë²•

### 1) í™”ë©´ ì´ë™ ë°©ë²• 1 - HTML í™œìš©

- ë²„íŠ¼ : `<button onclick="location.href='ì´ë™í• í˜ì´ì§€'"></button>` 

- form íƒœê·¸ ë‚´ì˜ submit ë²„íŠ¼ : 

  - ```html
    <form action="ì´ë™í• í˜ì´ì§€" method="post">
            <input type="text" name="id" value="abc">
            <input type="password" name="pw" value="123">
            <input type="submit">    
    </form>
    ```

  - form íƒœê·¸ ë‚´ë¶€ì˜ ëª¨ë“  input ë°ì´í„°ë¥¼ formì˜ action ì†ì„±ì— ì§€ì •í•œ ê³³ìœ¼ë¡œ ì „ì†¡

  - **method="post" ëª…ì‹œí•˜ë©´ POSTë°©ì‹**ìœ¼ë¡œ ì „ì†¡ / **defaultëŠ” GETë°©ì‹**

- ë§í¬ : `<a href="ì´ë™í• í˜ì´ì§€">` 



<br>

### 2) í™”ë©´ ì´ë™ ë°©ë²• 2 - Servlet API í™œìš©

#### (1) Forward

- web container ì°¨ì›ì—ì„œì˜ í˜ì´ì§€ ì´ë™ (ì›¹ ë¸Œë¼ìš°ì €ëŠ” í™”ë©´ ì´ë™í–ˆëŠ”ì§€ ì•Œì§€ ëª»í•¨)
- ë”°ë¼ì„œ ì›¹ë¸Œë¼ìš°ì € ìƒì—ëŠ” ìµœì´ˆì— í˜¸ì¶œí•œ URLë§Œ í‘œì‹œë¨
- **ìš”ì²­ ì •ë³´ë¥¼ ê·¸ëŒ€ë¡œ ì „ë‹¬í•¨** 
  - ì‹œìŠ¤í…œì— ë³€í™”ê°€ ìƒê¸°ì§€ ì•ŠëŠ” ë‹¨ìˆœ ì¡°íšŒ ìš”ì²­(ê¸€ ëª©ë¡ ë³´ê¸°, ê²€ìƒ‰)ì— ì´ìš©í•˜ëŠ” ê²ƒì´ ì ì ˆ

```java
request.getRequestDispatcher("ì´ë™í• í˜ì´ì§€").forward(request, response);
```

<img src="./img/servlet8.PNG">

#### (2) Redirect

- URL ìì²´ë¥¼ ë³€ê²½í•˜ëŠ” ê¸°ìˆ 
- **Request, Response ê°ì²´ë¥¼ ìƒˆë¡­ê²Œ ìƒì„±**
  - ì‹œìŠ¤í…œì— ë³€í™”ê°€ ìƒê¸°ëŠ” ìš”ì²­(ê¸€ì“°ê¸°, íšŒì›ê°€ì… ë“±)ì— ì´ìš©í•˜ëŠ” ê²ƒì´ ì ì ˆ
  - ì˜ˆë¥¼ ë“¤ì–´ ë¸”ë¡œê·¸ ê¸€ì“°ê¸° ê¸°ëŠ¥ ìˆ˜í–‰ì‹œ, redirect ë°©ì‹ìœ¼ë¡œ ì‘ë‹µ í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬ì•¼ ìƒˆë¡œê³ ì¹¨ì„ ëˆŒëŸ¬ë„ ê°™ì€ ê²Œì‹œë¬¼ì´ ì—¬ëŸ¬ë²ˆ ë“±ë¡ë˜ì§€ ì•ŠìŒ

```java
response.sendRedirect("ì´ë™í• í˜ì´ì§€");
```

<img src="./img/servlet9.PNG">

## ìƒíƒœìœ ì§€ ê¸°ìˆ 

í˜ì´ì§€ë¥¼ ì´ë™í•´ë„ ì •ë³´ë¥¼ ìœ ì§€í• ìˆ˜ ìˆê²Œ í•˜ëŠ” ê¸°ìˆ 

> ğŸ’¡ HTTPì˜ ê¸°ë³¸ íŠ¹ì„±
>
> - ë¬´ìƒíƒœì„±
> - ë¹„ì—°ê²°ì„±
>
> í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ í•œë²ˆ ì—°ê²°ì„ ë§ºì€ ë’¤, ìš”ì²­ê³¼ ì‘ë‹µì´ ëë‚˜ê³  ì—°ê²°ì´ ëŠê¸°ë©´  ìƒíƒœê°€ ìœ ì§€ë˜ì§€ ì•ŠëŠ” íŠ¹ì„±ì´ ìˆë‹¤.  



### 1) Cookie

ìƒíƒœì •ë³´ë¥¼ **client systemì— ì €ì¥**í•˜ì—¬ ìœ ì§€í•˜ëŠ” ê¸°ìˆ 

- textì— í•œí•´ì„œë§Œ ì €ì¥ (ìµœëŒ€ 4KBì˜ ë¬¸ìì—´)
- íƒ€ ë²¤ë”ì‚¬ ë¸Œë¼ìš°ì € ì‚¬ìš©ì‹œ ì¿ í‚¤ ì •ë³´ëŠ” ë¸Œë¼ìš°ì € ë‚´ë¶€ì˜ ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥ ê°€ëŠ¥
- âš¡ ì£¼ì˜!! ë³´ì•ˆì„ ê³ ë ¤í•œ ì¤‘ìš”í•œ ë°ì´í„°ëŠ” ì¿ í‚¤ í™œìš©í•˜ë©´ ì•ˆë¨!! 



<br>

âœ… **ì¿ í‚¤ ìƒì„± ë° ì‚¬ìš© ì‹¤ìŠµ**

<login.html>

```html
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Insert title here</title>
</head>
<body>
	<form action="check" method="post">
		<input type="text" name="id" value="person"> <br>
		<input type="password" name="pw" value="123"> <br>
		<input type="submit" value="ë¡œê·¸ì¸">
	</form>

</body>
</html>
```



<Validation.java>

```java
package controller;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/check")
public class Validation extends HttpServlet {

	protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        
        String id = request.getParameter("id");
        String pw = request.getParameter("pw");
        
        if(id.equals("abc") && pw.equals("123")) {            
            // ì¿ í‚¤ìƒì„± - "name"ì´ë¼ëŠ” keyë¡œ "hyem" ë§¤í•‘
            Cookie msg = new Cookie("name", "hyem");
            // í´ë¼ì´ì–¸íŠ¸ ì‹œìŠ¤í…œì— ì €ì¥í•˜ê³ ì í•˜ëŠ” ì‹œê°„ì„ ì´ˆë‹¨ìœ„ë¡œ ì„¤ì •
            msg.setMaxAge(60*60*24*365);  // (1ë…„ìœ¼ë¡œ ì„¤ì •)
            // í´ë¼ì´ì–¸íŠ¸ ì‹œìŠ¤í…œì— ì „ì†¡í•´ì„œ ì €ì¥
            response.addCookie(msg);
            
            response.sendRedirect("success");
        
        } else {
            request.setAttribute("failMsg", "ì¸ì¦ ì‹¤íŒ¨");
            request.getRequestDispatcher("view/fail").forward(request, response);
        }
    }

}
```



<Success.java>

```java
package view;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/success")
public class Success extends HttpServlet {
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html;charset=utf-8");
        PrintWriter out = response.getWriter();
        
        // í´ë¼ì´ì–¸íŠ¸ ì‹œìŠ¤í…œì—ì„œ í•´ë‹¹ ë„ë©”ì¸ì˜ ì¿ í‚¤ì •ë³´ íšë“
        Cookie [] all = request.getCookies();
        for(Cookie c : all) {
            if(c.getName().equals("name")) {
                out.println(c.getValue());
            }
        }
        out.println("ë°˜ê°‘ìŠµë‹ˆë‹¤");
    }

}
```



<Fail.java>

```java
package view;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/view/fail")
public class Fail extends HttpServlet {
	protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html;charset=utf-8");
        PrintWriter out = response.getWriter();
        out.println(request.getAttribute("failMsg"));  // ì¸ì¦ ì‹¤íŒ¨ ì¶œë ¥
    }
    
}
```



ğŸª **ì¿ í‚¤ì˜ ì¢…ë¥˜**

- ë§Œë£Œ ê¸°ê°„ì— ë”°ë¼

  - ì˜êµ¬ ì¿ í‚¤(Persistent Cookie) : ë§Œë£Œ ê¸°ê°„ì´ ëë‚˜ë©´ ì‚­ì œ
  - ì„¸ì…˜ ì¿ í‚¤(Session Cookie) : ë¸Œë¼ìš°ì € ì¢…ë£Œì‹œ ì‚­ì œ

- ìƒì„±ëœ ë„ë©”ì¸ì— ë”°ë¼

  - í¼ìŠ¤íŠ¸íŒŒí‹° ì¿ í‚¤(First party Cookie) : ê°™ì€ ë„ë©”ì¸/ì„œë¸Œë„ë©”ì¸ì—ì„œ ìƒì„±ëœ ì¿ í‚¤
  - ì„œë“œíŒŒí‹° ì¿ í‚¤(Third party Cookie) : ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œ ìƒì„±ëœ ì¿ í‚¤ 
  - A ë„ë©”ì¸ì— ì ‘ì†í–ˆì„ ë•Œ, A ë„ë©”ì¸ ë‚´ì—ì„œ B ë„ë©”ì¸ìœ¼ë¡œ ìš”ì²­ì„ í•˜ëŠ” ê²½ìš°(ìŠ¤í¬ë¦½íŠ¸, ì´ë¯¸ì§€, í°íŠ¸, ì•„ì´í”„ë ˆì„ ë“±)ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° ì„œë“œíŒŒí‹° ì¿ í‚¤(Bë„ë©”ì¸ì˜ ì¿ í‚¤)ê°€ ìƒì„±ëœë‹¤ 
  - ì„œë“œíŒŒí‹° ì¿ í‚¤ëŠ” ì£¼ë¡œ ê´‘ê³  ëª©ì ìœ¼ë¡œ í™œìš©

  

  

ğŸ¤” **ì¿ í‚¤ì˜ ë¬¸ì œì **

- ë³´ì•ˆìƒ ë¬¸ì œ : ì¿ í‚¤ê°€ ìë™ìœ¼ë¡œ ì „ì†¡ëœë‹¤ëŠ” íŠ¹ì§•ì„ ì´ìš©, ì‚¬ìš©ìì—ê²Œ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆìŒ)
  - CSRF - ì‚¬ìš©ìì˜ ê¶Œí•œì„ ì´ìš©í•œ ê³µê²© (ë¡œê·¸ì¸ëœ ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½, ê²°ì œìš”ì²­ ë“±)
  - XSS - ì‚¬ìš©ìì˜ í† í°ê³¼ ê°™ì€ ë¯¼ê°í•œ ì •ë³´ íƒˆì·¨
- ë¶€ì¡±í•œ ì €ì¥ ìš©ëŸ‰
- ë¶ˆí•„ìš”í•œ íŠ¸ë˜í”½ ì¦ê°€ (HTTP ìš”ì²­ ì‹œ ìë™ìœ¼ë¡œ ëª¨ë“  ì¿ í‚¤ ì „ì†¡í•˜ê¸° ë•Œë¬¸ì—)





<br>

### 2) Session

ìƒíƒœì •ë³´ë¥¼ **server system**ì— ì €ì¥í•˜ì—¬ ìœ ì§€í•˜ëŠ” ê¸°ìˆ 

- í´ë¼ì´ì–¸íŠ¸ ì‹œìŠ¤í…œì— ì €ì¥í•˜ëŠ” ì¿ í‚¤ë³´ë‹¨ ë³´ì•ˆ ê³ ë ¤ / ì•ˆì •ì 

- í•˜ì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ê°€ ë§ì•„ì§ˆìˆ˜ë¡ ì„œë²„ ë¶€í•˜ ì•¼ê¸° - ë‹¤ë¥¸ ìƒíƒœ ìœ ì§€ ê¸°ìˆ (í† í°...)ê³¼ ì ì ˆíˆ í˜¼ìš©í•´ì•¼ í•¨

  â€‹	 

<br>

âœ… **ì„¸ì…˜ ìƒì„± ë° ì‚¬ìš© ì‹¤ìŠµ**

ì•„ê¹Œ ìœ„ì˜ ì‹¤ìŠµ ì½”ë“œì—ì„œëŠ” request ê°ì²´ì— fail messageë¥¼ ì €ì¥í•˜ê³ , Validation.javaì—ì„œ Fail.javaë¡œ ë„˜ì–´ê°ˆ ë•Œ `forward` ë°©ì‹ì„ ì‚¬ìš©í•´ì„œ request ì •ë³´ë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€ì‹œì¼°ë‹¤. í•˜ì§€ë§Œ ë§Œì•½ `redirect` ë°©ì‹ìœ¼ë¡œ í™”ë©´ ì´ë™ì„ í–ˆë‹¤ë©´ ì €ì¥í•œ fail message ì •ë³´ê°€ íœ˜ë°œë˜ì—ˆì„ ê²ƒì´ë‹¤.

sessionì„ ì‚¬ìš©í•´ì„œ ì •ë³´ë¥¼ ìœ ì§€ì‹œì¼œë³´ì.

```java
package controller;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

@WebServlet("/check")
public class Validation extends HttpServlet {
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String id = request.getParameter("id");
        String pw = request.getParameter("pw");
        
        if(id.equals("abc") && pw.equals("123")) {
            Cookie msg = new Cookie("name", "hyem");
            msg.setMaxAge(60*60*24*365);
            response.addCookie(msg);
            
            response.sendRedirect("success");
        
        } else {
            // redirect ë°©ì‹ì€ í™”ë©´ì´ë™ì‹œ requestê°’ ì†Œë©¸ - session ìƒì„±í•˜ì!
            // í´ë¼ì´ì–¸íŠ¸ê°€ ìµœì´ˆ ìš”ì²­ì´ë©´ Session ID ìƒì„±, IDê°€ ì´ë¯¸ ìˆë‹¤ë©´ ì¬ì‚¬ìš©í•˜ëŠ” ì½”ë“œì„
            HttpSession session = request.getSession();
            session.setAttribute("failMsg", "ì¸ì¦ ì‹¤íŒ¨");
            
            response.sendRedirect("view/fail");
        }
    }

}
```



âœ… ì„¸ì…˜ ìƒì„±ì‹œ í´ë¼ì´ì–¸íŠ¸ ì‹œìŠ¤í…œì—ëŠ” **ì„¸ì…˜ì¿ í‚¤**ê°€ ìƒì„±ëœë‹¤!

í¬ë¡¬ ë¸Œë¼ìš°ì €ì˜ `ì„¤ì •`ì—ì„œ `ëª¨ë“  ì¿ í‚¤ ë° ì‚¬ì´íŠ¸ ë°ì´í„° ë³´ê¸°`ì— ë“¤ì–´ê°€ë©´, localhostì— `JSESSIONID` ë¼ëŠ” ì´ë¦„ì˜ ì¿ í‚¤ê°€ ìƒì„±ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. 

<img src="./img/movepage1.PNG">

- ì„¸ì…˜ì€ ë¸Œë¼ìš°ì €ë‹¹ í•˜ë‚˜ì”© ìƒì„±ëœë‹¤.

- ` HttpSession session = request.getSession();` ì½”ë“œëŠ”
  - í´ë¼ì´ì–¸íŠ¸ê°€ ìµœì´ˆ ìš”ì²­ ì‹œ - Session ID ìƒì„± 
  - ê°™ì€ í´ë¼ì´ì–¸íŠ¸ê°€ ë‹¤ì‹œ ë‹¤ë¥¸ ìš”ì²­ ì‹œ - í•´ë‹¹ ì„¸ì…˜ ì•„ì´ë””ë¥¼ í™œìš©
- ê²°ê³¼ì ìœ¼ë¡œ ì›¹ ì»¨í…Œì´ë„ˆëŠ” í´ë¼ì´ì–¸íŠ¸ ë¸Œë¼ìš°ì €ì— ì¿ í‚¤ë¡œ ì €ì¥í•œ JSSESSIONIDë¡œ í´ë¼ì´ì–¸íŠ¸ ë¸Œë¼ìš°ì €ë“¤ì„ êµ¬ë¶„í•œë‹¤.



<Fail.java>

```java
package view;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

@WebServlet("/view/fail")
public class Fail extends HttpServlet {
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html;charset=utf-8");
        PrintWriter out = response.getWriter();
        
        // ì„¸ì…˜ ìƒì„±(X), ì´ë¯¸ ì´ í´ë¼ì´ì–¸íŠ¸ ì‹œìŠ¤í…œì—ì„œ JSESSIONIDê°’ ë§Œë“¤ì–´ì ¸ ìˆê¸° ë•Œë¬¸ì— ì¬ì‚¬ìš©(O)
        HttpSession session = request.getSession();
        out.println(session.getAttribute("failMsg"));
        
        // ë”ì´ìƒ ì„¸ì…˜ ì‚¬ìš© ì•ˆí•˜ëŠ” ìƒí™©(ë¡œê·¸ì•„ì›ƒ)ì´ë¼ ê°€ì • - ìì›í•´ì œ í•´ì„œ ë©”ëª¨ë¦¬ ì ˆì•½ í•„ìˆ˜
        session.invalidate();
        session = null;
    }
    
}
```

